{"remainingRequest":"D:\\Programs\\Project\\gin-vue-admin-master\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Programs\\Project\\gin-vue-admin-master\\web\\src\\view\\superAdmin\\authority\\components\\datas.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Programs\\Project\\gin-vue-admin-master\\web\\src\\view\\superAdmin\\authority\\components\\datas.vue","mtime":1600866450000},{"path":"D:\\Programs\\Project\\gin-vue-admin-master\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\gin-vue-admin-master\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\gin-vue-admin-master\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\gin-vue-admin-master\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7c2V0RGF0YUF1dGhvcml0eX0gZnJvbSAnQC9hcGkvYXV0aG9yaXR5JwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0RhdGFzJywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgICBhdXRob3JpdHlzOltdLAogICAgICAgIGRhdGFBdXRob3JpdHlJZDpbXSwKICAgICAgICBuZWVkQ29uZmlybTpmYWxzZQogICAgfQogIH0sCiAgcHJvcHM6IHsKICAgIHJvdzogewogICAgICBkZWZhdWx0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4ge30KICAgICAgfSwKICAgICAgdHlwZTogT2JqZWN0CiAgICB9LAogICAgYXV0aG9yaXR5OiB7CiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB7fQogICAgICB9LAogICAgICB0eXBlOiBBcnJheQogICAgfQogIH0sCiAgbWV0aG9kczp7CiAgICAvLyDmmrTpnLLnu5nlpJblsYLkvb/nlKjnmoTliIfmjaLmi6bmiKrnu5/kuIDmlrnms5UKICAgICAgZW50ZXJBbmROZXh0KCl7CiAgICAgICAgdGhpcy5hdXRoRGF0YUVudGVyKCkKICAgICAgfSwKICAgICAgYWxsKCl7CiAgICAgICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkID0gWy4uLnRoaXMuYXV0aG9yaXR5c10KICAgICAgICAgdGhpcy5yb3cuZGF0YUF1dGhvcml0eUlkID0gdGhpcy5kYXRhQXV0aG9yaXR5SWQKICAgICAgICAgdGhpcy5uZWVkQ29uZmlybSA9IHRydWUKICAgICAgfSwKICAgICAgc2VsZigpewogICAgICAgICAgdGhpcy5kYXRhQXV0aG9yaXR5SWQgPSB0aGlzLmF1dGhvcml0eXMuZmlsdGVyKGl0ZW09Pml0ZW0uYXV0aG9yaXR5SWQ9PT10aGlzLnJvdy5hdXRob3JpdHlJZCkKICAgICAgICAgIHRoaXMucm93LmRhdGFBdXRob3JpdHlJZCA9IHRoaXMuZGF0YUF1dGhvcml0eUlkCiAgICAgICAgICB0aGlzLm5lZWRDb25maXJtID0gdHJ1ZQogICAgICB9LAogICAgICBzZWxmQW5kQ2hpbGRyZW4oKXsKICAgICAgICAgY29uc3QgYXJyQm94ID0gW10KICAgICAgICAgdGhpcy5nZXRDaGlsZHJlbklkKHRoaXMucm93LGFyckJveCkKICAgICAgICAgdGhpcy5kYXRhQXV0aG9yaXR5SWQgPSB0aGlzLmF1dGhvcml0eXMuZmlsdGVyKGl0ZW09PmFyckJveC5pbmRleE9mKGl0ZW0uYXV0aG9yaXR5SWQpPi0xKQogICAgICAgICB0aGlzLnJvdy5kYXRhQXV0aG9yaXR5SWQgPSB0aGlzLmRhdGFBdXRob3JpdHlJZAogICAgICAgICB0aGlzLm5lZWRDb25maXJtID0gdHJ1ZQogICAgICB9LAogICAgICBnZXRDaGlsZHJlbklkKHJvdyxhcnJCb3gpewogICAgICAgICAgYXJyQm94LnB1c2gocm93LmF1dGhvcml0eUlkKQogICAgICAgICAgcm93LmNoaWxkcmVuJiZyb3cuY2hpbGRyZW4ubWFwKGl0ZW09PnsKICAgICAgICAgICAgICB0aGlzLmdldENoaWxkcmVuSWQoaXRlbSxhcnJCb3gpCiAgICAgICAgICB9KQogICAgICB9LAogICAgLy8g5o+Q5LqkCiAgICAgIGFzeW5jIGF1dGhEYXRhRW50ZXIoKXsKICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHNldERhdGFBdXRob3JpdHkodGhpcy5yb3cpCiAgICAgICAgICBpZihyZXMuY29kZSA9PSAwKXsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsgdHlwZTogJ3N1Y2Nlc3MnLCBtZXNzYWdlOiAi6LWE5rqQ6K6+572u5oiQ5YqfIiB9KQogICAgICAgICAgfQogICAgICB9LAogICAgLy8gICDlubPpk7rop5LoibIKICAgICAgcm91bmRBdXRob3JpdHkoYXV0aG9yaXR5cyl7CiAgICAgICAgICBhdXRob3JpdHlzJiZhdXRob3JpdHlzLm1hcChpdGVtPT57CiAgICAgICAgICAgICAgY29uc3Qgb2JqID0ge30KICAgICAgICAgICAgICBvYmouYXV0aG9yaXR5SWQgPSBpdGVtLmF1dGhvcml0eUlkCiAgICAgICAgICAgICAgb2JqLmF1dGhvcml0eU5hbWUgPSBpdGVtLmF1dGhvcml0eU5hbWUKICAgICAgICAgICAgICB0aGlzLmF1dGhvcml0eXMucHVzaChvYmopCiAgICAgICAgICAgICAgaWYoaXRlbS5jaGlsZHJlbiYmaXRlbS5jaGlsZHJlbi5sZW5ndGgpewogICAgICAgICAgICAgICAgICB0aGlzLnJvdW5kQXV0aG9yaXR5KGl0ZW0uY2hpbGRyZW4pCiAgICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgfSwKICAgIC8vICAg6YCJ5oupCiAgICAgIHNlbGVjdEF1dGhvcml0eSgpewogICAgICAgICAgdGhpcy5yb3cuZGF0YUF1dGhvcml0eUlkID0gdGhpcy5kYXRhQXV0aG9yaXR5SWQKICAgICAgICAgIHRoaXMubmVlZENvbmZpcm0gPSB0cnVlCiAgICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICAgIHRoaXMuYXV0aG9yaXR5cyA9IFtdCiAgICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkID0gW10KICAgICAgdGhpcy5yb3VuZEF1dGhvcml0eSh0aGlzLmF1dGhvcml0eSkKICAgICAgdGhpcy5yb3cuZGF0YUF1dGhvcml0eUlkJiZ0aGlzLnJvdy5kYXRhQXV0aG9yaXR5SWQubWFwKGl0ZW09PnsKICAgICAgICAgIGNvbnN0IG9iaiA9IHRoaXMuYXV0aG9yaXR5cyYmdGhpcy5hdXRob3JpdHlzLmZpbHRlcihhdT0+YXUuYXV0aG9yaXR5SWQgPT09IGl0ZW0uYXV0aG9yaXR5SWQpJiZ0aGlzLmF1dGhvcml0eXMuZmlsdGVyKGF1PT5hdS5hdXRob3JpdHlJZCA9PT0gaXRlbS5hdXRob3JpdHlJZClbMF0KICAgICAgICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkLnB1c2gob2JqKQogICAgICB9KQogIH0KfQo="},{"version":3,"sources":["datas.vue"],"names":[],"mappings":";;;;;;;;;;;;;;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"datas.vue","sourceRoot":"src/view/superAdmin/authority/components","sourcesContent":["<template>\n  <div>\n      <div class=\"clearflex\" style=\"margin:18px\">\n      <el-button @click=\"authDataEnter\" class=\"fl-right\" size=\"small\" type=\"primary\">确 定</el-button>\n      <el-button @click=\"all\" class=\"fl-left\" size=\"small\" type=\"primary\">全选</el-button>\n      <el-button @click=\"self\" class=\"fl-left\" size=\"small\" type=\"primary\">本角色</el-button>\n      <el-button @click=\"selfAndChildren\" class=\"fl-left\" size=\"small\" type=\"primary\">本角色及子角色</el-button>\n    </div>\n     <el-checkbox-group v-model=\"dataAuthorityId\" @change=\"selectAuthority\">\n        <el-checkbox v-for=\"(item,key) in authoritys\" :label=\"item\" :key=\"key\">{{item.authorityName}}</el-checkbox>\n    </el-checkbox-group>\n  </div>\n</template>\n<script>\nimport {setDataAuthority} from '@/api/authority'\nexport default {\n  name: 'Datas',\n  data() {\n    return {\n        authoritys:[],\n        dataAuthorityId:[],\n        needConfirm:false\n    }\n  },\n  props: {\n    row: {\n      default: function() {\n        return {}\n      },\n      type: Object\n    },\n    authority: {\n      default: function() {\n        return {}\n      },\n      type: Array\n    }\n  },\n  methods:{\n    // 暴露给外层使用的切换拦截统一方法\n      enterAndNext(){\n        this.authDataEnter()\n      },\n      all(){\n         this.dataAuthorityId = [...this.authoritys]\n         this.row.dataAuthorityId = this.dataAuthorityId\n         this.needConfirm = true\n      },\n      self(){\n          this.dataAuthorityId = this.authoritys.filter(item=>item.authorityId===this.row.authorityId)\n          this.row.dataAuthorityId = this.dataAuthorityId\n          this.needConfirm = true\n      },\n      selfAndChildren(){\n         const arrBox = []\n         this.getChildrenId(this.row,arrBox)\n         this.dataAuthorityId = this.authoritys.filter(item=>arrBox.indexOf(item.authorityId)>-1)\n         this.row.dataAuthorityId = this.dataAuthorityId\n         this.needConfirm = true\n      },\n      getChildrenId(row,arrBox){\n          arrBox.push(row.authorityId)\n          row.children&&row.children.map(item=>{\n              this.getChildrenId(item,arrBox)\n          })\n      },\n    // 提交\n      async authDataEnter(){\n          const res = await setDataAuthority(this.row)\n          if(res.code == 0){\n              this.$message({ type: 'success', message: \"资源设置成功\" })\n          }\n      },\n    //   平铺角色\n      roundAuthority(authoritys){\n          authoritys&&authoritys.map(item=>{\n              const obj = {}\n              obj.authorityId = item.authorityId\n              obj.authorityName = item.authorityName\n              this.authoritys.push(obj)\n              if(item.children&&item.children.length){\n                  this.roundAuthority(item.children)\n              }\n          })\n      },\n    //   选择\n      selectAuthority(){\n          this.row.dataAuthorityId = this.dataAuthorityId\n          this.needConfirm = true\n      }\n  },\n  created() {\n      this.authoritys = []\n      this.dataAuthorityId = []\n      this.roundAuthority(this.authority)\n      this.row.dataAuthorityId&&this.row.dataAuthorityId.map(item=>{\n          const obj = this.authoritys&&this.authoritys.filter(au=>au.authorityId === item.authorityId)&&this.authoritys.filter(au=>au.authorityId === item.authorityId)[0]\n          this.dataAuthorityId.push(obj)\n      })\n  }\n}\n</script>\n<style lang=\"less\">\n</style>"]}]}