{"remainingRequest":"D:\\Programs\\Project\\GSL-IOT\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Programs\\Project\\GSL-IOT\\web\\src\\view\\superAdmin\\api\\api.vue?vue&type=style&index=0&id=1ed9dbea&scoped=true&lang=scss&","dependencies":[{"path":"D:\\Programs\\Project\\GSL-IOT\\web\\src\\view\\superAdmin\\api\\api.vue","mtime":1600866450000},{"path":"D:\\Programs\\Project\\GSL-IOT\\web\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\GSL-IOT\\web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\GSL-IOT\\web\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\GSL-IOT\\web\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\GSL-IOT\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\GSL-IOT\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmJ1dHRvbi1ib3ggewogIHBhZGRpbmc6IDEwcHggMjBweDsKICAuZWwtYnV0dG9uIHsKICAgIGZsb2F0OiByaWdodDsKICB9Cn0KLmVsLXRhZy0tbWluaSB7CiAgbWFyZ2luLWxlZnQ6IDVweDsKfQoud2FybmluZyB7CiAgY29sb3I6ICNkYzE0M2M7Cn0K"},{"version":3,"sources":["api.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"api.vue","sourceRoot":"src/view/superAdmin/api","sourcesContent":["<template>\n  <div>\n    <div class=\"search-term\">\n      <el-form :inline=\"true\" :model=\"searchInfo\" class=\"demo-form-inline\">\n        <el-form-item label=\"路径\">\n          <el-input placeholder=\"路径\" v-model=\"searchInfo.path\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"描述\">\n          <el-input placeholder=\"描述\" v-model=\"searchInfo.description\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"api组\">\n          <el-input placeholder=\"api组\" v-model=\"searchInfo.apiGroup\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"请求\">\n          <el-select clearable placeholder=\"请选择\" v-model=\"searchInfo.method\">\n            <el-option\n              :key=\"item.value\"\n              :label=\"`${item.label}(${item.value})`\"\n              :value=\"item.value\"\n              v-for=\"item in methodOptions\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item>\n          <el-button @click=\"onSubmit\" type=\"primary\">查询</el-button>\n        </el-form-item>\n        <el-form-item>\n          <el-button @click=\"openDialog('addApi')\" type=\"primary\">新增api</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <el-table :data=\"tableData\" @sort-change=\"sortChange\" border stripe>\n      <el-table-column label=\"id\" min-width=\"60\" prop=\"ID\" sortable=\"custom\"></el-table-column>\n      <el-table-column label=\"api路径\" min-width=\"150\" prop=\"path\" sortable=\"custom\"></el-table-column>\n      <el-table-column label=\"api分组\" min-width=\"150\" prop=\"apiGroup\" sortable=\"custom\"></el-table-column>\n      <el-table-column label=\"api简介\" min-width=\"150\" prop=\"description\" sortable=\"custom\"></el-table-column>\n      <el-table-column label=\"请求\" min-width=\"150\" prop=\"method\" sortable=\"custom\">\n        <template slot-scope=\"scope\">\n          <div>\n            {{scope.row.method}}\n            <el-tag\n              :key=\"scope.row.methodFiletr\"\n              :type=\"scope.row.method|tagTypeFiletr\"\n              effect=\"dark\"\n              size=\"mini\"\n            >{{scope.row.method|methodFiletr}}</el-tag>\n            <!-- {{scope.row.method|methodFiletr}} -->\n          </div>\n        </template>\n      </el-table-column>\n\n      <el-table-column fixed=\"right\" label=\"操作\" width=\"200\">\n        <template slot-scope=\"scope\">\n          <el-button @click=\"editApi(scope.row)\" size=\"small\" type=\"primary\" icon=\"el-icon-edit\">编辑</el-button>\n          <el-button @click=\"deleteApi(scope.row)\" size=\"small\" type=\"danger\" icon=\"el-icon-delete\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-pagination\n      :current-page=\"page\"\n      :page-size=\"pageSize\"\n      :page-sizes=\"[10, 30, 50, 100]\"\n      :style=\"{float:'right',padding:'20px'}\"\n      :total=\"total\"\n      @current-change=\"handleCurrentChange\"\n      @size-change=\"handleSizeChange\"\n      layout=\"total, sizes, prev, pager, next, jumper\"\n    ></el-pagination>\n\n    <el-dialog :before-close=\"closeDialog\" :title=\"dialogTitle\" :visible.sync=\"dialogFormVisible\">\n      <el-form :inline=\"true\" :model=\"form\" :rules=\"rules\" label-width=\"80px\" ref=\"apiForm\">\n        <el-form-item label=\"路径\" prop=\"path\">\n          <el-input autocomplete=\"off\" v-model=\"form.path\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"请求\" prop=\"method\">\n          <el-select placeholder=\"请选择\" v-model=\"form.method\">\n            <el-option\n              :key=\"item.value\"\n              :label=\"`${item.label}(${item.value})`\"\n              :value=\"item.value\"\n              v-for=\"item in methodOptions\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"api分组\" prop=\"apiGroup\">\n          <el-input autocomplete=\"off\" v-model=\"form.apiGroup\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"api简介\" prop=\"description\">\n          <el-input autocomplete=\"off\" v-model=\"form.description\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div class=\"warning\">新增Api需要在角色管理内配置权限才可使用</div>\n      <div class=\"dialog-footer\" slot=\"footer\">\n        <el-button @click=\"closeDialog\">取 消</el-button>\n        <el-button @click=\"enterDialog\" type=\"primary\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n\n<script>\n// 获取列表内容封装在mixins内部  getTableData方法 初始化已封装完成 条件搜索时候 请把条件安好后台定制的结构体字段 放到 this.searchInfo 中即可实现条件搜索\n\nimport {\n  getApiById,\n  getApiList,\n  createApi,\n  updateApi,\n  deleteApi\n} from '@/api/api'\nimport infoList from '@/components/mixins/infoList'\nimport { toSQLLine } from '@/utils/stringFun'\nconst methodOptions = [\n  {\n    value: 'POST',\n    label: '创建',\n    type: 'success'\n  },\n  {\n    value: 'GET',\n    label: '查看',\n    type: ''\n  },\n  {\n    value: 'PUT',\n    label: '更新',\n    type: 'warning'\n  },\n  {\n    value: 'DELETE',\n    label: '删除',\n    type: 'danger'\n  }\n]\n\nexport default {\n  name: 'Api',\n  mixins: [infoList],\n  data() {\n    return {\n      listApi: getApiList,\n      dialogFormVisible: false,\n      dialogTitle: '新增Api',\n      form: {\n        path: '',\n        apiGroup: '',\n        method: '',\n        description: ''\n      },\n      methodOptions: methodOptions,\n      type: '',\n      rules: {\n        path: [{ required: true, message: '请输入api路径', trigger: 'blur' }],\n        apiGroup: [\n          { required: true, message: '请输入组名称', trigger: 'blur' }\n        ],\n        method: [\n          { required: true, message: '请选择请求方式', trigger: 'blur' }\n        ],\n        description: [\n          { required: true, message: '请输入api介绍', trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  methods: {\n    // 排序\n    sortChange({ prop, order }) {\n      if (prop) {\n        this.searchInfo.orderKey = toSQLLine(prop)\n        this.searchInfo.desc = order == 'descending'\n      }\n      this.getTableData()\n    },\n    //条件搜索前端看此方法\n    onSubmit() {\n      this.page = 1\n      this.pageSize = 10\n      this.getTableData()\n    },\n    initForm() {\n      this.$refs.apiForm.resetFields()\n      this.form= {\n        path: '',\n        apiGroup: '',\n        method: '',\n        description: ''\n      }\n    },\n    closeDialog() {\n      this.initForm()\n      this.dialogFormVisible = false\n    },\n    openDialog(type) {\n      switch (type) {\n        case 'addApi':\n          this.dialogTitlethis = '新增Api'\n          break\n        case 'edit':\n          this.dialogTitlethis = '编辑Api'\n          break\n        default:\n          break\n      }\n      this.type = type\n      this.dialogFormVisible = true\n    },\n    async editApi(row) {\n      const res = await getApiById({ id: row.ID })\n      this.form = res.data.api\n      this.openDialog('edit')\n    },\n    async deleteApi(row) {\n      this.$confirm('此操作将永久删除所有角色下该菜单, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      })\n        .then(async () => {\n          const res = await deleteApi(row)\n          if (res.code == 0) {\n            this.$message({\n              type: 'success',\n              message: '删除成功!'\n            })\n            this.getTableData()\n          }\n        })\n        .catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          })\n        })\n    },\n    async enterDialog() {\n      this.$refs.apiForm.validate(async valid => {\n        if (valid) {\n          switch (this.type) {\n            case 'addApi':\n              {\n                const res = await createApi(this.form)\n                if (res.code == 0) {\n                  this.$message({\n                    type: 'success',\n                    message: '添加成功',\n                    showClose: true\n                  })\n                }\n                this.getTableData()\n                this.closeDialog()\n              }\n\n              break\n            case 'edit':\n              {\n                const res = await updateApi(this.form)\n                if (res.code == 0) {\n                  this.$message({\n                    type: 'success',\n                    message: '编辑成功',\n                    showClose: true\n                  })\n                }\n                this.getTableData()\n                this.closeDialog()\n              }\n              break\n            default:\n              {\n                this.$message({\n                  type: 'error',\n                  message: '未知操作',\n                  showClose: true\n                })\n              }\n              break\n          }\n        }\n      })\n    }\n  },\n  filters: {\n    methodFiletr(value) {\n      const target = methodOptions.filter(item => item.value === value)[0]\n      // return target && `${target.label}(${target.value})`\n      return target && `${target.label}`\n    },\n    tagTypeFiletr(value) {\n      const target = methodOptions.filter(item => item.value === value)[0]\n      return target && `${target.type}`\n    }\n  },\n  created(){\n    this.getTableData()\n  }\n}\n</script>\n<style scoped lang=\"scss\">\n.button-box {\n  padding: 10px 20px;\n  .el-button {\n    float: right;\n  }\n}\n.el-tag--mini {\n  margin-left: 5px;\n}\n.warning {\n  color: #dc143c;\n}\n</style>"]}]}